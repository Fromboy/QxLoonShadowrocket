# å®˜æ–¹æ–‡æ¡£ï¼šhttps://doc.egernapp.com
# Author: https://github.com/Repcz
# TG: https://t.me/QVQ_Channel
# æœ€åæ›´æ–°æ—¶é—´: 2025-09-11
# Egern Version â‰¥ v2.0.0(552)
# Egern ç®€æ´é…ç½®ï¼Œåªæœ‰å›½å†…ğŸ‡¨ğŸ‡³å’Œä»£ç†ğŸŒ 
# url = https://raw.githubusercontent.com/Fromboy/QxLoonShadowrocket/refs/heads/Egern/EgernLite.yaml
# ================================
# IPV6 é»˜è®¤å…³é—­
ipv6: false
# TUNæ¨¡å¼
vif_only: true
# åŠ«æŒ DNS æœåŠ¡å™¨
hijack_dns:
- '*:53'
# httpä»£ç†ç«¯å£
http_port: 3080
# socks5ä»£ç†ç«¯å£
socks_port: 3090
allow_external_connections: true

# è‡ªå®šä¹‰ MaxMind GeoIP æ•°æ®åº“ï¼ˆç”¨äºåœ°ç†ä½ç½®åŒ¹é…ï¼‰
geoip_db_url: https://raw.githubusercontent.com/Loyalsoldier/geoip/release/Country.mmdb

# è‡ªå®šä¹‰ ASN æ•°æ®åº“ï¼ˆç”¨äºè¿è¥å•†åŒ¹é…ï¼Œå¯é€‰ï¼‰
asn_db_url: https://raw.githubusercontent.com/Loyalsoldier/geoip/release/GeoLite2-ASN.mmdb

# ä»£ç†å’Œç›´è¿å»¶è¿Ÿæµ‹è¯• URL
proxy_latency_test_url: http://1.1.1.1/generate_204
direct_latency_test_url: http://connectivitycheck.platform.hicloud.com/generate_204

# DNS é…ç½®
dns:
  # å¼•å¯¼ DNSï¼ˆè§£æä¸Šæ¸¸ DNSï¼‰
  bootstrap:
      - system
  # ä¸Šæ¸¸ DNS æœåŠ¡å™¨ï¼ˆå›½å†…å…¬å…± DNSï¼‰
  upstreams:
    Domestic-DNS:
      - 223.5.5.5
      - 119.29.29.29
  # DNS è½¬å‘è§„åˆ™ï¼ˆæ‰€æœ‰åŸŸåä½¿ç”¨å›½å†… DNSï¼‰
  forward:
    - wildcard:
        match: "*"
        value: Domestic-DNS

# ä»£ç†ç»„é…ç½®
policy_groups:
  # ä¸»ä»£ç†ç»„ï¼šæ‰‹åŠ¨é€‰æ‹©èŠ‚ç‚¹
  - select:
      name: å…¨çƒèŠ‚ç‚¹
      policies:
        - é¦™æ¸¯èŠ‚ç‚¹
        - ç¾å›½èŠ‚ç‚¹
        - æ—¥æœ¬èŠ‚ç‚¹
        - éŸ©å›½èŠ‚ç‚¹
        - ç‹®åŸèŠ‚ç‚¹
      icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Global.png

  # é¦™æ¸¯èŠ‚ç‚¹ï¼ˆè‡ªåŠ¨é€‰æ‹©ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹ï¼‰
  - auto_test:
      name: é¦™æ¸¯èŠ‚ç‚¹
      policies:
        - æ‰‹åŠ¨é€‰æ‹©
      flatten: true
      filter: (?i)ğŸ‡­ğŸ‡°|é¦™æ¸¯|(\b(HK|Hong)\b)
      tolerance: 0
      icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Hong_Kong.png

  # ç¾å›½èŠ‚ç‚¹
  - auto_test:
      name: ç¾å›½èŠ‚ç‚¹
      policies:
        - æ‰‹åŠ¨é€‰æ‹©
      flatten: true
      filter: (?i)ğŸ‡ºğŸ‡¸|ç¾å›½|æ´›æ‰çŸ¶|åœ£ä½•å¡|(\b(US|United States)\b)
      tolerance: 0
      icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/United_States.png

  # æ—¥æœ¬èŠ‚ç‚¹
  - auto_test:
      name: æ—¥æœ¬èŠ‚ç‚¹
      policies:
        - æ‰‹åŠ¨é€‰æ‹©
      flatten: true
      filter: (?i)ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|ä¸œäº¬|(\b(JP|Japan)\b)
      tolerance: 0
      icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Japan.png

  # éŸ©å›½èŠ‚ç‚¹ï¼ˆæ–°å¢ï¼‰
  - auto_test:
      name: éŸ©å›½èŠ‚ç‚¹
      policies:
        - æ‰‹åŠ¨é€‰æ‹©
      flatten: true
      filter: (?i)ğŸ‡°ğŸ‡·|éŸ©å›½|é¦–å°”|(\b(KR|Korea)\b)
      tolerance: 0
      icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/South_Korea.png

  # æ–°åŠ å¡èŠ‚ç‚¹ï¼ˆç‹®åŸï¼‰
  - auto_test:
      name: ç‹®åŸèŠ‚ç‚¹
      policies:
        - æ‰‹åŠ¨é€‰æ‹©
      flatten: true
      filter: (?i)ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|ç‹®|(\b(SG|Singapore)\b)
      tolerance: 0
      icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Singapore.png

  # æ‰‹åŠ¨é€‰æ‹©ï¼ˆä»å¤–éƒ¨æœåŠ¡è·å–èŠ‚ç‚¹åˆ—è¡¨ï¼‰
  - external:
      name: æ‰‹åŠ¨é€‰æ‹©
      type: select
      urls:
        - http://your-service-provider
      hidden: false
      icon: https://github.com/Repcz/Repcz.github.io/raw/main/docs/egern/Photo/Egern.png

# åˆ†æµè§„åˆ™
rules:
  - rule_set:
    match: https://raw.githubusercontent.com/Fromboy/QxLoonShadowrocket/refs/heads/Egern/EgernAI.yaml
    policy: å…¨çƒèŠ‚ç‚¹
    update_interval: 86400
    disabled: false
  - rule_set:
    name: å±è”½ç³»ç»Ÿæ›´æ–°âŒ
    match: https://raw.githubusercontent.com/Fromboy/QxLoonShadowrocket/refs/heads/Egern/EgernSoftwareUpdates.yaml
    policy: REJECT
    update_interval: 86400
    disabled: false
  # ç›´è¿è§„åˆ™ï¼ˆå›½å†…æµé‡ï¼‰
  - rule_set:
      match: https://github.com/Repcz/Tool/raw/X/Egern/Rules/Direct.yaml
      policy: DIRECT

  # æ‹’ç»è§„åˆ™ï¼ˆå¹¿å‘Šã€è·Ÿè¸ªç­‰ï¼‰
  - rule_set:
      match: https://github.com/Repcz/Tool/raw/X/Egern/Rules/Reject.yaml
      policy: REJECT

  # å›½å¤–ç½‘ç«™èµ°ä»£ç†
  - rule_set:
      match: https://github.com/Repcz/Tool/raw/X/Egern/Rules/ProxyGFW.yaml
      policy: å…¨çƒèŠ‚ç‚¹

  # ä¸­å›½å¤§é™† IP ç›´è¿
  - geoip:
      match: CN
      policy: DIRECT

  # é»˜è®¤è§„åˆ™ï¼ˆå…œåº•ï¼Œèµ°å…¨çƒèŠ‚ç‚¹ï¼‰
  - default:
      policy: å…¨çƒèŠ‚ç‚¹

# MITM é…ç½®ï¼ˆé»˜è®¤ç¦ç”¨ï¼Œé™¤ééœ€è¦ï¼‰
mitm:
  enabled: true

# æ¨¡å—ï¼ˆå…¨éƒ¨ç¦ç”¨ï¼Œç®€åŒ–é…ç½®ï¼‰
modules:
  - name: SubStore
  url: https://raw.githubusercontent.com/sub-store-org/Sub-Store/refs/heads/master/config/Egern.yaml
  enabled: false
